<!DOCTYPE html>
<html>
<head>
    <title>Memory Game</title>
    <style>
        #game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            width: 100vw;
            height: 100vh;
            justify-items: center;
            align-items: center;
        }
        .card {
            width: 300px;
            height: 300px;
            background: #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 6em;
        }
        .card.flipped, .card.matched {
            background: #fff;
        }
        .card.flipped::before, .card.matched::before {
            content: attr(data-emoji);
            font-size: 300%;
        }
        .card.matched {
            visibility: hidden;
        }
    </style>
</head>
<body>
    <div id="game-board">
        <!-- The game board will be populated here -->
    </div>

    <script>
        // Define an array of 9 unique emojis
        const emojis = ['🐻', '🐢', '🦁', '🐰', '🐼', '🐨', '🐯', '🦊', '🐸'];

        // Function to shuffle array
        function shuffle(array) {
            let currentIndex = array.length, temporaryValue, randomIndex;
            while (0 !== currentIndex) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }
            return array;
        }

        // Randomly select 4 unique emojis from the emojis array and duplicate them
        const selectedEmojis = [];
        for (let i = 0; i < 4; i++) {
            const randomIndex = Math.floor(Math.random() * emojis.length);
            selectedEmojis.push(emojis[randomIndex], emojis[randomIndex]);
            emojis.splice(randomIndex, 1);
        }

        // Add the joker to the selected emojis
        selectedEmojis.push('🃏');

        // Populate the game board with shuffled emojis and add event listeners
        const gameBoard = document.getElementById('game-board');
        const shuffledEmojis = shuffle(selectedEmojis);
        let flippedCards = [];
        for (let i = 0; i < 9; i++) {
            const card = document.createElement('div');
            card.classList.add('card');
            card.dataset.emoji = shuffledEmojis[i];
            function flipCard() {
                this.classList.add('flipped');
                flippedCards.push(this);
                if (flippedCards.length === 2) {
                    if (flippedCards[0].dataset.emoji === flippedCards[1].dataset.emoji) {
                        setTimeout(function() {
                            if (flippedCards.includes(flippedCards[0]) && flippedCards.includes(flippedCards[1])) {
                                flippedCards[0].classList.add('matched');
                                flippedCards[1].classList.add('matched');
                                flippedCards[0].dataset.emoji = '';
                                flippedCards[1].dataset.emoji = '';
                                flippedCards = [];
                                checkWin();
                            }
                        }, 3000);

        // Function to check if the game is won
        function checkWin() {
            const cards = document.querySelectorAll('.card');
            if ([...cards].every(card => card.classList.contains('matched') || card.dataset.emoji === '🃏')) {
                celebrate();
            }
        }

        // Function to start the celebration animation
        function celebrate() {
            const celebrationEmojis = ['🎉', '🎊', '🎈', '🥳'];
            let intervalId = setInterval(function() {
                const cards = document.querySelectorAll('.card:not(.matched)');
                if (cards.length) {
                    const randomIndex = Math.floor(Math.random() * cards.length);
                    cards[randomIndex].dataset.emoji = celebrationEmojis[Math.floor(Math.random() * celebrationEmojis.length)];
                    cards[randomIndex].classList.add('flipped');
                } else {
                    clearInterval(intervalId);
                    setTimeout(resetGame, 3000);
                }
            }, 250);
        }

        // Function to reset the game
        function resetGame() {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.classList.remove('flipped', 'matched');
                card.dataset.emoji = '';
            });
            startGame();
        }
                    } else {
                        setTimeout(function() {
                            flippedCards[0].classList.remove('flipped');
                            flippedCards[1].classList.remove('flipped');
                            flippedCards = [];
                        }, 1000);
                    }
                }
            }
            card.addEventListener('click', flipCard);
            gameBoard.appendChild(card);
        }
    </script>
</body>
</html>
